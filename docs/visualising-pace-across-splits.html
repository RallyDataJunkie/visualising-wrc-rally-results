<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8 Visualising Pace Across Splits | Visualising WRC Rally Timing and Results Data</title>
  <meta name="description" content="An introduction to visualising timing and results data for WRC rally events." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="8 Visualising Pace Across Splits | Visualising WRC Rally Timing and Results Data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to visualising timing and results data for WRC rally events." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8 Visualising Pace Across Splits | Visualising WRC Rally Timing and Results Data" />
  
  <meta name="twitter:description" content="An introduction to visualising timing and results data for WRC rally events." />
  

<meta name="author" content="Tony Hirst" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-split-times.html"/>

<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/htmlwidgets-1.5.3.9000/htmlwidgets.js"></script>
<script src="libs/formattable_widget-binding-0.2.1/formattable_widget.js"></script>
<link href="libs/jquery-sparkline-2.1.2/jquery.sparkline.css" rel="stylesheet" />
<script src="libs/jquery-sparkline-2.1.2/jquery.sparkline.js"></script>
<script src="libs/sparkline-binding-2.0/sparkline.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"><strong>Visualising WRC Rally Results and Timing Data</strong></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Index</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html"><i class="fa fa-check"></i><b>2</b> Accessing Data from the WRC Live Timing API</a>
<ul>
<li class="chapter" data-level="2.1" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#current-season-rallies"><i class="fa fa-check"></i><b>2.1</b> Current Season Rallies</a></li>
<li class="chapter" data-level="2.2" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#itinerary-lookup"><i class="fa fa-check"></i><b>2.2</b> Itinerary Lookup</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#leg-sections"><i class="fa fa-check"></i><b>2.2.1</b> Leg Sections</a></li>
<li class="chapter" data-level="2.2.2" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#time-controls"><i class="fa fa-check"></i><b>2.2.2</b> Time Controls</a></li>
<li class="chapter" data-level="2.2.3" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#stage-details"><i class="fa fa-check"></i><b>2.2.3</b> Stage Details</a></li>
<li class="chapter" data-level="2.2.4" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#road-order-start-lists"><i class="fa fa-check"></i><b>2.2.4</b> Road Order Start Lists</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#competitor-details"><i class="fa fa-check"></i><b>2.3</b> Competitor Details</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#looking-up-entries-by-group"><i class="fa fa-check"></i><b>2.3.1</b> Looking Up Entries by Group</a></li>
<li class="chapter" data-level="2.3.2" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#driver-codriver-details"><i class="fa fa-check"></i><b>2.3.2</b> Driver &amp; Codriver Details</a></li>
<li class="chapter" data-level="2.3.3" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#summarising-essential-entry-data"><i class="fa fa-check"></i><b>2.3.3</b> Summarising Essential Entry Data</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#penalties-and-retirements"><i class="fa fa-check"></i><b>2.4</b> Penalties and Retirements</a></li>
<li class="chapter" data-level="2.5" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#results-and-stage-winner"><i class="fa fa-check"></i><b>2.5</b> Results and Stage Winner</a></li>
<li class="chapter" data-level="2.6" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#stage-result"><i class="fa fa-check"></i><b>2.6</b> Stage Result</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#getting-stage-results-for-multiple-stages"><i class="fa fa-check"></i><b>2.6.1</b> Getting Stage Results for Multiple Stages</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#stage-times"><i class="fa fa-check"></i><b>2.7</b> Stage Times</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#getting-stage-times-for-multiple-stages"><i class="fa fa-check"></i><b>2.7.1</b> Getting Stage Times for Multiple Stages</a></li>
<li class="chapter" data-level="2.7.2" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#getting-wide-stage-times-for-multiple-stages"><i class="fa fa-check"></i><b>2.7.2</b> Getting Wide Stage Times for Multiple Stages</a></li>
<li class="chapter" data-level="2.7.3" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#getting-wide-stage-positions"><i class="fa fa-check"></i><b>2.7.3</b> Getting Wide Stage Positions</a></li>
<li class="chapter" data-level="2.7.4" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#getting-generic-wide-dataframes"><i class="fa fa-check"></i><b>2.7.4</b> Getting Generic Wide Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#split-times"><i class="fa fa-check"></i><b>2.8</b> Split Times</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#driver-split-times-detail"><i class="fa fa-check"></i><b>2.8.1</b> Driver Split Times Detail</a></li>
<li class="chapter" data-level="2.8.2" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#wide-driver-split-times"><i class="fa fa-check"></i><b>2.8.2</b> Wide Driver Split Times</a></li>
<li class="chapter" data-level="2.8.3" data-path="accessing-data-from-the-wrc-live-timing-api.html"><a href="accessing-data-from-the-wrc-live-timing-api.html#multiple-stage-long-splits-data"><i class="fa fa-check"></i><b>2.8.3</b> Multiple Stage Long Splits Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html"><i class="fa fa-check"></i><b>3</b> Visualising Results for a Single Stage</a>
<ul>
<li class="chapter" data-level="3.1" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#load-base-data"><i class="fa fa-check"></i><b>3.1</b> Load Base Data</a></li>
<li class="chapter" data-level="3.2" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#get-stage-results-data"><i class="fa fa-check"></i><b>3.2</b> Get Stage Results Data</a></li>
<li class="chapter" data-level="3.3" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#previewing-stage-results-data"><i class="fa fa-check"></i><b>3.3</b> Previewing Stage Results Data</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#adding-entry-metadata"><i class="fa fa-check"></i><b>3.3.1</b> Adding Entry Metadata</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#adding-stage-metadata-to-table-captions"><i class="fa fa-check"></i><b>3.4</b> Adding Stage Metadata to Table Captions</a></li>
<li class="chapter" data-level="3.5" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#colour-highlighting-stage-results"><i class="fa fa-check"></i><b>3.5</b> Colour Highlighting Stage Results</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#heatmap-style-column-cell-backgrounds"><i class="fa fa-check"></i><b>3.5.1</b> Heatmap Style Column Cell Backgrounds</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#an-aside-calculating-diff-and-gap-times"><i class="fa fa-check"></i><b>3.6</b> An Aside — Calculating DIFF and GAP times</a></li>
<li class="chapter" data-level="3.7" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#rebasing-stage-results"><i class="fa fa-check"></i><b>3.7</b> Rebasing Stage Results</a></li>
<li class="chapter" data-level="3.8" data-path="visualising-results-for-a-single-stage.html"><a href="visualising-results-for-a-single-stage.html#colour-highlighting-rebased-values"><i class="fa fa-check"></i><b>3.8</b> Colour Highlighting Rebased Values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html"><i class="fa fa-check"></i><b>4</b> Visualising Results for Multiple Stages</a>
<ul>
<li class="chapter" data-level="4.1" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#load-base-data-1"><i class="fa fa-check"></i><b>4.1</b> Load Base Data</a></li>
<li class="chapter" data-level="4.2" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#retrieving-mutliple-stage-results"><i class="fa fa-check"></i><b>4.2</b> Retrieving Mutliple Stage Results</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#reshaping-overall-position-data"><i class="fa fa-check"></i><b>4.2.1</b> Reshaping Overall Position Data</a></li>
<li class="chapter" data-level="4.2.2" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#reshaping-overall-rally-time-data"><i class="fa fa-check"></i><b>4.2.2</b> Reshaping Overall Rally Time Data</a></li>
<li class="chapter" data-level="4.2.3" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#reshaping-time-to-first-data"><i class="fa fa-check"></i><b>4.2.3</b> Reshaping Time to First Data</a></li>
<li class="chapter" data-level="4.2.4" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#mapping-stage-and-driver-identifiers-to-meaningful-labels"><i class="fa fa-check"></i><b>4.2.4</b> Mapping Stage and Driver Identifiers to Meaningful Labels</a></li>
<li class="chapter" data-level="4.2.5" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#rebasing-overall-times"><i class="fa fa-check"></i><b>4.2.5</b> Rebasing Overall Times</a></li>
<li class="chapter" data-level="4.2.6" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#finding-changes-in-rebased-gaps-across-stages"><i class="fa fa-check"></i><b>4.2.6</b> Finding Changes in Rebased Gaps Across Stages</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-overall-results"><i class="fa fa-check"></i><b>4.3</b> Visualising Overall Results</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-first-position"><i class="fa fa-check"></i><b>4.3.1</b> Visualising First Position</a></li>
<li class="chapter" data-level="4.3.2" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-position-changes-over-a-rally"><i class="fa fa-check"></i><b>4.3.2</b> Visualising Position Changes Over a Rally</a></li>
<li class="chapter" data-level="4.3.3" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-position-gainslosses"><i class="fa fa-check"></i><b>4.3.3</b> Visualising Position Gains/Losses</a></li>
<li class="chapter" data-level="4.3.4" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#per-driver-position-charts"><i class="fa fa-check"></i><b>4.3.4</b> Per Driver Position Charts</a></li>
<li class="chapter" data-level="4.3.5" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-time-to-first"><i class="fa fa-check"></i><b>4.3.5</b> Visualising Time to First</a></li>
<li class="chapter" data-level="4.3.6" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-rebased-gaps"><i class="fa fa-check"></i><b>4.3.6</b> Visualising Rebased Gaps</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#retrieving-stage-times-and-results"><i class="fa fa-check"></i><b>4.4</b> Retrieving Stage Times and Results</a></li>
<li class="chapter" data-level="4.5" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#visualising-stage-times"><i class="fa fa-check"></i><b>4.5</b> Visualising Stage Times</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#stage-position-sparklines"><i class="fa fa-check"></i><b>4.5.1</b> Stage Position Sparklines</a></li>
<li class="chapter" data-level="4.5.2" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#gap-to-stage-winner-sparklines"><i class="fa fa-check"></i><b>4.5.2</b> Gap to Stage Winner Sparklines</a></li>
<li class="chapter" data-level="4.5.3" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#stage-position-charts"><i class="fa fa-check"></i><b>4.5.3</b> Stage Position Charts</a></li>
<li class="chapter" data-level="4.5.4" data-path="visualising-results-for-multiple-stages.html"><a href="visualising-results-for-multiple-stages.html#individual-stage-position-charts"><i class="fa fa-check"></i><b>4.5.4</b> Individual Stage position Charts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html"><i class="fa fa-check"></i><b>5</b> Finding Pace Across Stages</a>
<ul>
<li class="chapter" data-level="5.1" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#load-base-data-2"><i class="fa fa-check"></i><b>5.1</b> Load Base Data</a></li>
<li class="chapter" data-level="5.2" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#defining-pace"><i class="fa fa-check"></i><b>5.2</b> Defining Pace</a></li>
<li class="chapter" data-level="5.3" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#calculating-stage-pace"><i class="fa fa-check"></i><b>5.3</b> Calculating Stage Pace</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#calculating-pace-for-a-single-stage"><i class="fa fa-check"></i><b>5.3.1</b> Calculating Pace for a Single Stage</a></li>
<li class="chapter" data-level="5.3.2" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#calculating-pace-for-multiple-stages"><i class="fa fa-check"></i><b>5.3.2</b> Calculating Pace for Multiple Stages</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#rebasing-stage-pace"><i class="fa fa-check"></i><b>5.4</b> Rebasing Stage Pace</a></li>
<li class="chapter" data-level="5.5" data-path="finding-pace-across-stages.html"><a href="finding-pace-across-stages.html#the-ultimate-rally"><i class="fa fa-check"></i><b>5.5</b> The Ultimate Rally</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualising-stage-pace.html"><a href="visualising-stage-pace.html"><i class="fa fa-check"></i><b>6</b> Visualising Stage Pace</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualising-stage-pace.html"><a href="visualising-stage-pace.html#load-base-data-3"><i class="fa fa-check"></i><b>6.1</b> Load Base Data</a></li>
<li class="chapter" data-level="6.2" data-path="visualising-stage-pace.html"><a href="visualising-stage-pace.html#pace-maps"><i class="fa fa-check"></i><b>6.2</b> Pace Maps</a></li>
<li class="chapter" data-level="6.3" data-path="visualising-stage-pace.html"><a href="visualising-stage-pace.html#a-pace-map-function"><i class="fa fa-check"></i><b>6.3</b> A Pace Map Function</a></li>
<li class="chapter" data-level="6.4" data-path="visualising-stage-pace.html"><a href="visualising-stage-pace.html#off-the-pace-charts"><i class="fa fa-check"></i><b>6.4</b> Off-the-Pace Charts</a></li>
<li class="chapter" data-level="6.5" data-path="visualising-stage-pace.html"><a href="visualising-stage-pace.html#comparing-pace-across-stages"><i class="fa fa-check"></i><b>6.5</b> Comparing Pace Across Stages</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="working-with-split-times.html"><a href="working-with-split-times.html"><i class="fa fa-check"></i><b>7</b> Working With Split Times</a>
<ul>
<li class="chapter" data-level="7.1" data-path="working-with-split-times.html"><a href="working-with-split-times.html#load-base-data-4"><i class="fa fa-check"></i><b>7.1</b> Load Base Data</a></li>
<li class="chapter" data-level="7.2" data-path="working-with-split-times.html"><a href="working-with-split-times.html#get-splits-data"><i class="fa fa-check"></i><b>7.2</b> Get Splits Data</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="working-with-split-times.html"><a href="working-with-split-times.html#split-locations"><i class="fa fa-check"></i><b>7.2.1</b> Split Locations</a></li>
<li class="chapter" data-level="7.2.2" data-path="working-with-split-times.html"><a href="working-with-split-times.html#mapping-split-codes-to-split-numbers"><i class="fa fa-check"></i><b>7.2.2</b> Mapping Split Codes to Split Numbers</a></li>
<li class="chapter" data-level="7.2.3" data-path="working-with-split-times.html"><a href="working-with-split-times.html#split-times-1"><i class="fa fa-check"></i><b>7.2.3</b> Split Times</a></li>
<li class="chapter" data-level="7.2.4" data-path="working-with-split-times.html"><a href="working-with-split-times.html#wide-driver-split-times-1"><i class="fa fa-check"></i><b>7.2.4</b> Wide Driver Split Times</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="working-with-split-times.html"><a href="working-with-split-times.html#rebasing-split-times"><i class="fa fa-check"></i><b>7.3</b> Rebasing Split Times</a></li>
<li class="chapter" data-level="7.4" data-path="working-with-split-times.html"><a href="working-with-split-times.html#visualising-rebased-split-times-using-sparklines"><i class="fa fa-check"></i><b>7.4</b> Visualising Rebased Split Times Using Sparklines</a></li>
<li class="chapter" data-level="7.5" data-path="working-with-split-times.html"><a href="working-with-split-times.html#finding-the-rank-position-at-each-split-point"><i class="fa fa-check"></i><b>7.5</b> Finding the Rank Position at Each Split Point</a></li>
<li class="chapter" data-level="7.6" data-path="working-with-split-times.html"><a href="working-with-split-times.html#finding-split-section-durations"><i class="fa fa-check"></i><b>7.6</b> Finding Split Section Durations</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="working-with-split-times.html"><a href="working-with-split-times.html#finding-split-section-ranks"><i class="fa fa-check"></i><b>7.6.1</b> Finding Split Section Ranks</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="working-with-split-times.html"><a href="working-with-split-times.html#adding-overall-stage-time-to-the-split-times"><i class="fa fa-check"></i><b>7.7</b> Adding Overall Stage Time to the Split Times</a></li>
<li class="chapter" data-level="7.8" data-path="working-with-split-times.html"><a href="working-with-split-times.html#calculating-the-ultimate-stage-from-ultimate-split-times"><i class="fa fa-check"></i><b>7.8</b> Calculating the Ultimate Stage from Ultimate Split Times</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="working-with-split-times.html"><a href="working-with-split-times.html#rebasing-to-ultimate-split-times"><i class="fa fa-check"></i><b>7.8.1</b> Rebasing to Ultimate Split Times</a></li>
<li class="chapter" data-level="7.8.2" data-path="working-with-split-times.html"><a href="working-with-split-times.html#per-split-ultimate-rebasing"><i class="fa fa-check"></i><b>7.8.2</b> Per Split Ultimate Rebasing</a></li>
<li class="chapter" data-level="7.8.3" data-path="working-with-split-times.html"><a href="working-with-split-times.html#ultimate-stage-rebasing"><i class="fa fa-check"></i><b>7.8.3</b> Ultimate Stage Rebasing</a></li>
<li class="chapter" data-level="7.8.4" data-path="working-with-split-times.html"><a href="working-with-split-times.html#actual-best-elapsed-time-rebasing"><i class="fa fa-check"></i><b>7.8.4</b> Actual Best Elapsed Time Rebasing</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="working-with-split-times.html"><a href="working-with-split-times.html#visualising-rebased-times"><i class="fa fa-check"></i><b>7.9</b> Visualising Rebased Times</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="working-with-split-times.html"><a href="working-with-split-times.html#context-sensistve-cell-colouring"><i class="fa fa-check"></i><b>7.9.1</b> Context Sensistve Cell Colouring</a></li>
<li class="chapter" data-level="7.9.2" data-path="working-with-split-times.html"><a href="working-with-split-times.html#using-sparklines-to-summarise-rebased-deltas"><i class="fa fa-check"></i><b>7.9.2</b> Using Sparklines to Summarise Rebased Deltas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html"><i class="fa fa-check"></i><b>8</b> Visualising Pace Across Splits</a>
<ul>
<li class="chapter" data-level="8.1" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#load-base-data-5"><i class="fa fa-check"></i><b>8.1</b> Load Base Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#obtaining-split-distances"><i class="fa fa-check"></i><b>8.1.1</b> Obtaining Split Distances</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#calculating-splits-pace"><i class="fa fa-check"></i><b>8.2</b> Calculating Splits Pace</a></li>
<li class="chapter" data-level="8.3" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#visualising-the-splits-pace"><i class="fa fa-check"></i><b>8.3</b> Visualising the Splits Pace</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#pace-over-each-section"><i class="fa fa-check"></i><b>8.3.1</b> Pace Over Each Section</a></li>
<li class="chapter" data-level="8.3.2" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#splits-sections-pace-maps"><i class="fa fa-check"></i><b>8.3.2</b> Splits Sections Pace Maps</a></li>
<li class="chapter" data-level="8.3.3" data-path="visualising-pace-across-splits.html"><a href="visualising-pace-across-splits.html#off-the-pace-splits-pace-mapping"><i class="fa fa-check"></i><b>8.3.3</b> Off-the-Pace Splits Pace Mapping</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://rallydatajunkie.com/"><em>RallyDataJunkie.com</em></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualising WRC Rally Timing and Results Data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualising-pace-across-splits" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Visualising Pace Across Splits</h1>
<p>We have already seen how we can perform pace calculations on stage level data and use pace maps and off-the-pace charts to visualise pace over the course of a rally.</p>
<p>But in WRC rallies at least, the stages are often long enough, and the promoter well resourced enough, to merit the collection of split data data at various split points along a stage. So in this chapter, we’ll review how we can create pace charts and apply the techniques to plotting progress <em>within</em> a stage, across stage splits.</p>
<div id="load-base-data-5" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Load Base Data</h2>
<p>As ever, load in the helper functions:</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="visualising-pace-across-splits.html#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;code/wrc-api.R&#39;</span>)</span>
<span id="cb355-2"><a href="visualising-pace-across-splits.html#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;code/wrc-wrangling.R&#39;</span>)</span>
<span id="cb355-3"><a href="visualising-pace-across-splits.html#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&#39;code/wrc-charts.R&#39;</span>)</span></code></pre></div>
<p>And get the base data:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="visualising-pace-across-splits.html#cb356-1" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> <span class="fu">get_active_season</span>()</span>
<span id="cb356-2"><a href="visualising-pace-across-splits.html#cb356-2" aria-hidden="true" tabindex="-1"></a>eventId <span class="ot">=</span> <span class="fu">get_eventId_from_name</span>(s, <span class="st">&#39;arctic&#39;</span>)</span>
<span id="cb356-3"><a href="visualising-pace-across-splits.html#cb356-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-4"><a href="visualising-pace-across-splits.html#cb356-4" aria-hidden="true" tabindex="-1"></a>itinerary <span class="ot">=</span> <span class="fu">get_itinerary</span>(eventId)</span>
<span id="cb356-5"><a href="visualising-pace-across-splits.html#cb356-5" aria-hidden="true" tabindex="-1"></a>sections <span class="ot">=</span> <span class="fu">get_sections</span>(itinerary)</span>
<span id="cb356-6"><a href="visualising-pace-across-splits.html#cb356-6" aria-hidden="true" tabindex="-1"></a>stages <span class="ot">=</span> <span class="fu">get_stages</span>(sections)</span>
<span id="cb356-7"><a href="visualising-pace-across-splits.html#cb356-7" aria-hidden="true" tabindex="-1"></a>stages_lookup <span class="ot">=</span> <span class="fu">get_stages_lookup</span>(stages)</span>
<span id="cb356-8"><a href="visualising-pace-across-splits.html#cb356-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-9"><a href="visualising-pace-across-splits.html#cb356-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick Lookups</span></span>
<span id="cb356-10"><a href="visualising-pace-across-splits.html#cb356-10" aria-hidden="true" tabindex="-1"></a>stage_list <span class="ot">=</span> <span class="fu">get_stage_list</span>(stages)</span>
<span id="cb356-11"><a href="visualising-pace-across-splits.html#cb356-11" aria-hidden="true" tabindex="-1"></a>stage_codes <span class="ot">=</span> stages<span class="sc">$</span>code</span>
<span id="cb356-12"><a href="visualising-pace-across-splits.html#cb356-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-13"><a href="visualising-pace-across-splits.html#cb356-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Driver details</span></span>
<span id="cb356-14"><a href="visualising-pace-across-splits.html#cb356-14" aria-hidden="true" tabindex="-1"></a>entries <span class="ot">=</span> <span class="fu">get_rally_entries</span>(eventId)</span>
<span id="cb356-15"><a href="visualising-pace-across-splits.html#cb356-15" aria-hidden="true" tabindex="-1"></a>cars <span class="ot">=</span> <span class="fu">get_car_data</span>(entries)</span></code></pre></div>
<p>Get a sample stage ID and associated splits:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="visualising-pace-across-splits.html#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get example stage ID</span></span>
<span id="cb357-2"><a href="visualising-pace-across-splits.html#cb357-2" aria-hidden="true" tabindex="-1"></a>stageId <span class="ot">=</span> stages_lookup[[<span class="st">&#39;SS3&#39;</span>]]</span>
<span id="cb357-3"><a href="visualising-pace-across-splits.html#cb357-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-4"><a href="visualising-pace-across-splits.html#cb357-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get splits for the stage</span></span>
<span id="cb357-5"><a href="visualising-pace-across-splits.html#cb357-5" aria-hidden="true" tabindex="-1"></a>splits <span class="ot">=</span> <span class="fu">get_splits</span>(eventId, stageId)</span>
<span id="cb357-6"><a href="visualising-pace-across-splits.html#cb357-6" aria-hidden="true" tabindex="-1"></a>splits_locations <span class="ot">=</span> <span class="fu">get_split_locations</span>(splits)</span>
<span id="cb357-7"><a href="visualising-pace-across-splits.html#cb357-7" aria-hidden="true" tabindex="-1"></a>splits_list <span class="ot">=</span> splits_locations<span class="sc">$</span>splitPointId</span>
<span id="cb357-8"><a href="visualising-pace-across-splits.html#cb357-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-9"><a href="visualising-pace-across-splits.html#cb357-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Get wide format data</span></span>
<span id="cb357-10"><a href="visualising-pace-across-splits.html#cb357-10" aria-hidden="true" tabindex="-1"></a>splits_wide <span class="ot">=</span> <span class="fu">get_splits_wide</span>(splits) <span class="sc">%&gt;%</span></span>
<span id="cb357-11"><a href="visualising-pace-across-splits.html#cb357-11" aria-hidden="true" tabindex="-1"></a>                <span class="fu">relabel_times_df2</span>(splits_list, cars, <span class="at">typ=</span><span class="st">&#39;split&#39;</span>)</span>
<span id="cb357-12"><a href="visualising-pace-across-splits.html#cb357-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-13"><a href="visualising-pace-across-splits.html#cb357-13" aria-hidden="true" tabindex="-1"></a>splits_wide <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   code split_1 split_2 split_3 split_4 split_5
## 1  OGI   161.7   272.3   471.3   690.4   789.2
## 2  EVA   162.3   273.7   472.3   692.1   792.4</code></pre>
<p>Get long form splits data for one or more stages, in this case, just a single stage:</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="visualising-pace-across-splits.html#cb359-1" aria-hidden="true" tabindex="-1"></a>splits_long <span class="ot">=</span> <span class="fu">get_multi_split_times</span>(stageId)</span></code></pre></div>
<div id="obtaining-split-distances" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Obtaining Split Distances</h3>
<p>We can find the distance between each split as the difference between consecutive values. Let’s augment the <em>splits_locations</em> with these values as well as with section start distances:</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="visualising-pace-across-splits.html#cb360-1" aria-hidden="true" tabindex="-1"></a>splits_locations<span class="sc">$</span>start_dist <span class="ot">=</span> <span class="fu">lag</span>(splits_locations<span class="sc">$</span>distance,</span>
<span id="cb360-2"><a href="visualising-pace-across-splits.html#cb360-2" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">default=</span><span class="dv">0</span>)</span>
<span id="cb360-3"><a href="visualising-pace-across-splits.html#cb360-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-4"><a href="visualising-pace-across-splits.html#cb360-4" aria-hidden="true" tabindex="-1"></a>splits_locations<span class="sc">$</span>section_dist <span class="ot">=</span> <span class="fu">c</span>(splits_locations<span class="sc">$</span>distance[<span class="dv">1</span>],</span>
<span id="cb360-5"><a href="visualising-pace-across-splits.html#cb360-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">diff</span>(splits_locations<span class="sc">$</span>distance))</span>
<span id="cb360-6"><a href="visualising-pace-across-splits.html#cb360-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-7"><a href="visualising-pace-across-splits.html#cb360-7" aria-hidden="true" tabindex="-1"></a>splits_locations</span></code></pre></div>
<pre><code>##   splitPointId stageId number distance splitname start_dist section_dist
## 1         3615    1750      1     4.83   split_1       0.00         4.83
## 2         3601    1750      2     9.02   split_2       4.83         4.19
## 3         3621    1750      3    14.87   split_3       9.02         5.85
## 4         3617    1750      4    20.63   split_4      14.87         5.76
## 5         3593    1750      5    23.21   split_5      20.63         2.58</code></pre>
<p>We can also retrieve these section distances into a <em>splitPointId</em> named list:</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="visualising-pace-across-splits.html#cb362-1" aria-hidden="true" tabindex="-1"></a>split_distances <span class="ot">=</span> splits_locations<span class="sc">$</span>section_dist</span>
<span id="cb362-2"><a href="visualising-pace-across-splits.html#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="visualising-pace-across-splits.html#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Label the values</span></span>
<span id="cb362-4"><a href="visualising-pace-across-splits.html#cb362-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(split_distances) <span class="ot">=</span> splits_locations<span class="sc">$</span>splitPointId</span>
<span id="cb362-5"><a href="visualising-pace-across-splits.html#cb362-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb362-6"><a href="visualising-pace-across-splits.html#cb362-6" aria-hidden="true" tabindex="-1"></a>split_distances</span></code></pre></div>
<pre><code>## 3615 3601 3621 3617 3593 
## 4.83 4.19 5.85 5.76 2.58</code></pre>
<p>We recall that the split points do not include the final timing line (the finish), so a complete set of distances also means we need to access the overall stage distance and account for that:</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="visualising-pace-across-splits.html#cb364-1" aria-hidden="true" tabindex="-1"></a>stage_dist <span class="ot">=</span> stages[stages[<span class="st">&#39;stageId&#39;</span>]<span class="sc">==</span>stageId,<span class="st">&#39;distance&#39;</span>]</span>
<span id="cb364-2"><a href="visualising-pace-across-splits.html#cb364-2" aria-hidden="true" tabindex="-1"></a>stage_dist</span></code></pre></div>
<pre><code>## [1] 24.43</code></pre>
<p>The complete set of intermediate distances is then:</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="visualising-pace-across-splits.html#cb366-1" aria-hidden="true" tabindex="-1"></a>full_split_distances <span class="ot">=</span> <span class="fu">c</span>(split_distances, stage_dist<span class="sc">-</span><span class="fu">sum</span>(split_distances))</span>
<span id="cb366-2"><a href="visualising-pace-across-splits.html#cb366-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-3"><a href="visualising-pace-across-splits.html#cb366-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(full_split_distances) <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">names</span>(split_distances), <span class="st">&#39;total&#39;</span>)</span>
<span id="cb366-4"><a href="visualising-pace-across-splits.html#cb366-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb366-5"><a href="visualising-pace-across-splits.html#cb366-5" aria-hidden="true" tabindex="-1"></a>full_split_distances</span></code></pre></div>
<pre><code>##  3615  3601  3621  3617  3593 total 
##  4.83  4.19  5.85  5.76  2.58  1.22</code></pre>
</div>
</div>
<div id="calculating-splits-pace" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Calculating Splits Pace</h2>
<p>To calculate pace between two split points we need to get the elapsed time between those two points as well as the distance between split points.</p>
<p>We can obtain the split differences by finding differences between the columns of the wide format dataframe using the <code>get_split_duration()</code> function we created previously:</p>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="visualising-pace-across-splits.html#cb368-1" aria-hidden="true" tabindex="-1"></a>split_cols <span class="ot">=</span> <span class="fu">get_split_cols</span>(splits)</span>
<span id="cb368-2"><a href="visualising-pace-across-splits.html#cb368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-3"><a href="visualising-pace-across-splits.html#cb368-3" aria-hidden="true" tabindex="-1"></a>split_durations_wide <span class="ot">=</span> <span class="fu">get_split_duration</span>(splits_wide, split_cols,</span>
<span id="cb368-4"><a href="visualising-pace-across-splits.html#cb368-4" aria-hidden="true" tabindex="-1"></a>                                          <span class="at">id_col=</span><span class="st">&#39;code&#39;</span>)</span></code></pre></div>
<pre><code>## Error in `[.data.frame`(df, , split_cols): undefined columns selected</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="visualising-pace-across-splits.html#cb370-1" aria-hidden="true" tabindex="-1"></a>split_durations_wide <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   code split_1 split_2 split_3 split_4 split_5
## 1  OGI   161.7   110.6   199.0   219.1    98.8
## 2  EVA   162.3   111.4   198.6   219.8   100.3
## 3  NEU   159.1   109.5   197.2   216.9   100.0</code></pre>
<p>We can then find the pace by dividing the split section times through by the split distances:</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="visualising-pace-across-splits.html#cb372-1" aria-hidden="true" tabindex="-1"></a>section_pace_wide <span class="ot">=</span> split_durations_wide</span>
<span id="cb372-2"><a href="visualising-pace-across-splits.html#cb372-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-3"><a href="visualising-pace-across-splits.html#cb372-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> splits_list) {</span>
<span id="cb372-4"><a href="visualising-pace-across-splits.html#cb372-4" aria-hidden="true" tabindex="-1"></a>  s_ <span class="ot">=</span> <span class="fu">as.character</span>(s)</span>
<span id="cb372-5"><a href="visualising-pace-across-splits.html#cb372-5" aria-hidden="true" tabindex="-1"></a>  section_pace_wide[,s_] <span class="ot">=</span> section_pace_wide[,s_] <span class="sc">/</span> split_distances[s_]</span>
<span id="cb372-6"><a href="visualising-pace-across-splits.html#cb372-6" aria-hidden="true" tabindex="-1"></a>                            </span>
<span id="cb372-7"><a href="visualising-pace-across-splits.html#cb372-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Error in `[.data.frame`(section_pace_wide, , s_): undefined columns selected</code></pre>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="visualising-pace-across-splits.html#cb374-1" aria-hidden="true" tabindex="-1"></a>section_pace_wide <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##   code split_1 split_2 split_3 split_4 split_5
## 1  OGI   161.7   110.6   199.0   219.1    98.8
## 2  EVA   162.3   111.4   198.6   219.8   100.3</code></pre>
</div>
<div id="visualising-the-splits-pace" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Visualising the Splits Pace</h2>
<p>To visualise the pace over each of the split sections, we can use exactly the same techniques that we used to visualise the stage pace, including pace maps and off-the-pace charts.</p>
<p>There are several different ways in which we might try to visualise pace. First, we can visualise absolute or rebased pace. Second, we can visualise pace <em>within</em> sections, using the times taken to get one split point to the next, or across the stage as a whole using the accumulated stage time.</p>
<div id="pace-over-each-section" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Pace Over Each Section</h3>
<p>One quick way of inspecting the pace over each section is to use a box plot:</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="visualising-pace-across-splits.html#cb376-1" aria-hidden="true" tabindex="-1"></a>section_pace_long <span class="ot">=</span> section_pace_wide <span class="sc">%&gt;%</span> </span>
<span id="cb376-2"><a href="visualising-pace-across-splits.html#cb376-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb376-3"><a href="visualising-pace-across-splits.html#cb376-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">gather</span>(splitPointId, pace,</span>
<span id="cb376-4"><a href="visualising-pace-across-splits.html#cb376-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.character</span>(splits_list)) <span class="sc">%&gt;%</span></span>
<span id="cb376-5"><a href="visualising-pace-across-splits.html#cb376-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">merge</span>(splits_locations[,<span class="fu">c</span>(<span class="st">&#39;splitPointId&#39;</span>,</span>
<span id="cb376-6"><a href="visualising-pace-across-splits.html#cb376-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&#39;start_dist&#39;</span>, <span class="st">&#39;distance&#39;</span>)],</span>
<span id="cb376-7"><a href="visualising-pace-across-splits.html#cb376-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">by=</span><span class="st">&#39;splitPointId&#39;</span>)</span></code></pre></div>
<pre><code>## Error: Can&#39;t subset columns that don&#39;t exist.
## x Columns `3615`, `3601`, `3621`, `3617`, and `3593` don&#39;t exist.</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="visualising-pace-across-splits.html#cb378-1" aria-hidden="true" tabindex="-1"></a>section_pace_long <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   splitPointId code     pace start_dist distance
## 1         3593  OGI 38.29457      20.63    23.21
## 2         3593  EVA 38.87597      20.63    23.21
## 3         3593  NEU 38.75969      20.63    23.21</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="visualising-pace-across-splits.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(section_pace_long[section_pace_long<span class="sc">$</span>pace<span class="sc">&lt;</span><span class="dv">40</span>,],</span>
<span id="cb380-2"><a href="visualising-pace-across-splits.html#cb380-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>distance, <span class="at">y=</span>pace)) <span class="sc">+</span></span>
<span id="cb380-3"><a href="visualising-pace-across-splits.html#cb380-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">group=</span>distance))</span></code></pre></div>
<p><img src="images/finding-splits-pace-pace-over-splits-box-1.png" width="672" />
This suggests that the section between the first and second split may be quite technical, and the final sections much faster.</p>
<p><em>Comparing section times against route metrics as described in <a href="https://rallydatajunkie.com/visualising-rally-stages/"><strong>Visualising Rally Stages</strong></a> will be the focus of a future unbook. Comparing manufacturer performance against different section and stage route types might also be worth further investigation.</em></p>
</div>
<div id="splits-sections-pace-maps" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Splits Sections Pace Maps</h3>
<p>To generate the pace map, let’s first rebase the split times with respect to a specified driver:</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="visualising-pace-across-splits.html#cb381-1" aria-hidden="true" tabindex="-1"></a>example_driver <span class="ot">=</span> section_pace_wide[<span class="dv">2</span>,]<span class="sc">$</span>code</span>
<span id="cb381-2"><a href="visualising-pace-across-splits.html#cb381-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-3"><a href="visualising-pace-across-splits.html#cb381-3" aria-hidden="true" tabindex="-1"></a>section_pace_wide_rebased <span class="ot">=</span> <span class="fu">rebase</span>(section_pace_wide, example_driver,</span>
<span id="cb381-4"><a href="visualising-pace-across-splits.html#cb381-4" aria-hidden="true" tabindex="-1"></a>                                   splits_list, <span class="at">id_col=</span><span class="st">&#39;code&#39;</span>)</span></code></pre></div>
<pre><code>## Error in `[.data.frame`(df, df[[id_col]] == id, rebase_cols): undefined columns selected</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="visualising-pace-across-splits.html#cb383-1" aria-hidden="true" tabindex="-1"></a>section_pace_wide_rebased <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   code       3615       3601        3621       3617       3593
## 1  OGI -0.1242236 -0.1909308  0.06837607 -0.1215278 -0.5813953
## 2  EVA  0.0000000  0.0000000  0.00000000  0.0000000  0.0000000
## 3  NEU -0.6625259 -0.4534606 -0.23931624 -0.5034722 -0.1162791</code></pre>
<p>To plot the pace map, we need to get the data into a long format:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="visualising-pace-across-splits.html#cb385-1" aria-hidden="true" tabindex="-1"></a>section_pace_long_rebased <span class="ot">=</span> section_pace_wide_rebased <span class="sc">%&gt;%</span> </span>
<span id="cb385-2"><a href="visualising-pace-across-splits.html#cb385-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb385-3"><a href="visualising-pace-across-splits.html#cb385-3" aria-hidden="true" tabindex="-1"></a>                <span class="fu">gather</span>(splitPointId, pace,</span>
<span id="cb385-4"><a href="visualising-pace-across-splits.html#cb385-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">as.character</span>(splits_list)) <span class="sc">%&gt;%</span></span>
<span id="cb385-5"><a href="visualising-pace-across-splits.html#cb385-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">merge</span>(splits_locations[,<span class="fu">c</span>(<span class="st">&#39;splitPointId&#39;</span>,</span>
<span id="cb385-6"><a href="visualising-pace-across-splits.html#cb385-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&#39;start_dist&#39;</span>, <span class="st">&#39;distance&#39;</span>)],</span>
<span id="cb385-7"><a href="visualising-pace-across-splits.html#cb385-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">by=</span><span class="st">&#39;splitPointId&#39;</span>)</span>
<span id="cb385-8"><a href="visualising-pace-across-splits.html#cb385-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-9"><a href="visualising-pace-across-splits.html#cb385-9" aria-hidden="true" tabindex="-1"></a>section_pace_long_rebased <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##   splitPointId code        pace start_dist distance
## 1         3593  OGI -0.58139535      20.63    23.21
## 2         3593  EVA  0.00000000      20.63    23.21
## 3         3593  NEU -0.11627907      20.63    23.21
## 4         3593  ROV  0.00000000      20.63    23.21
## 5         3593  KAT  0.03875969      20.63    23.21
## 6         3593  GRE -0.11627907      20.63    23.21</code></pre>
<p>We can now view the rebased pace over the splits:</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="visualising-pace-across-splits.html#cb387-1" aria-hidden="true" tabindex="-1"></a>section_pace_long_rebased <span class="sc">%&gt;%</span></span>
<span id="cb387-2"><a href="visualising-pace-across-splits.html#cb387-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pace_map</span>( <span class="at">xstart=</span><span class="st">&#39;start_dist&#39;</span>,</span>
<span id="cb387-3"><a href="visualising-pace-across-splits.html#cb387-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">drivers=</span><span class="fu">c</span>(<span class="st">&#39;KAT&#39;</span>,<span class="st">&#39;ROV&#39;</span>),</span>
<span id="cb387-4"><a href="visualising-pace-across-splits.html#cb387-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xend=</span><span class="st">&#39;distance&#39;</span>, <span class="at">id_col=</span><span class="st">&#39;code&#39;</span>, <span class="at">lines=</span><span class="cn">FALSE</span>, <span class="at">label_dodge=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/finding-splits-pace-example_pace_splits-1.png" width="672" /></p>
</div>
<div id="off-the-pace-splits-pace-mapping" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Off-the-Pace Splits Pace Mapping</h3>
<p>To review the off-the-pace performance over the splits on a stage, we can use the off-the-pace chart function applied to rebased elapsed times data..</p>
<p>Let’s get some rebased data using the accumulated stage time at each split, hackfix flipping the basis of the rebase for now until such a time as the off-the-pace chart is better behaved:</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="visualising-pace-across-splits.html#cb388-1" aria-hidden="true" tabindex="-1"></a>wide_splits_rebased <span class="ot">=</span> splits_wide <span class="sc">%&gt;%</span></span>
<span id="cb388-2"><a href="visualising-pace-across-splits.html#cb388-2" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">head</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb388-3"><a href="visualising-pace-across-splits.html#cb388-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">rebase</span>(example_driver,</span>
<span id="cb388-4"><a href="visualising-pace-across-splits.html#cb388-4" aria-hidden="true" tabindex="-1"></a>                               splits_locations<span class="sc">$</span>splitname,</span>
<span id="cb388-5"><a href="visualising-pace-across-splits.html#cb388-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">id_col=</span><span class="st">&#39;code&#39;</span>, <span class="at">flip=</span><span class="cn">TRUE</span>)</span>
<span id="cb388-6"><a href="visualising-pace-across-splits.html#cb388-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-7"><a href="visualising-pace-across-splits.html#cb388-7" aria-hidden="true" tabindex="-1"></a>wide_splits_rebased <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   code split_1 split_2 split_3 split_4 split_5
## 1  OGI     0.6     1.4     1.0     1.7     3.2
## 2  EVA     0.0     0.0     0.0     0.0     0.0
## 3  NEU     3.2     5.1     6.5     9.4     9.7</code></pre>
<p>We can convert this to long form and add in distance information:</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="visualising-pace-across-splits.html#cb390-1" aria-hidden="true" tabindex="-1"></a>long_splits_rebased <span class="ot">=</span> wide_splits_rebased <span class="sc">%&gt;%</span></span>
<span id="cb390-2"><a href="visualising-pace-across-splits.html#cb390-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(splits_locations<span class="sc">$</span>splitname,</span>
<span id="cb390-3"><a href="visualising-pace-across-splits.html#cb390-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">names_to =</span> <span class="st">&quot;splitname&quot;</span>,</span>
<span id="cb390-4"><a href="visualising-pace-across-splits.html#cb390-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">values_to =</span> <span class="st">&quot;sectionDurationS&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb390-5"><a href="visualising-pace-across-splits.html#cb390-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(splits_locations[,<span class="fu">c</span>(<span class="st">&#39;splitname&#39;</span>,<span class="st">&#39;distance&#39;</span>)],</span>
<span id="cb390-6"><a href="visualising-pace-across-splits.html#cb390-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">by=</span><span class="st">&#39;splitname&#39;</span>)</span>
<span id="cb390-7"><a href="visualising-pace-across-splits.html#cb390-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb390-8"><a href="visualising-pace-across-splits.html#cb390-8" aria-hidden="true" tabindex="-1"></a>long_splits_rebased <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##   splitname code sectionDurationS distance
## 1   split_1  OGI              0.6     4.83
## 2   split_1  BRE              3.9     4.83
## 3   split_1  ROV              2.7     4.83</code></pre>
<p>At the start of the chart, it’s convenient to add some zeroed values, so let’s create a dataframe to help us add those data points:</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="visualising-pace-across-splits.html#cb392-1" aria-hidden="true" tabindex="-1"></a>zero_df <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">code=</span><span class="fu">unique</span>(long_splits_rebased<span class="sc">$</span>code))</span>
<span id="cb392-2"><a href="visualising-pace-across-splits.html#cb392-2" aria-hidden="true" tabindex="-1"></a>zero_df<span class="sc">$</span>distance <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb392-3"><a href="visualising-pace-across-splits.html#cb392-3" aria-hidden="true" tabindex="-1"></a>zero_df<span class="sc">$</span>sectionDurationS<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb392-4"><a href="visualising-pace-across-splits.html#cb392-4" aria-hidden="true" tabindex="-1"></a>zero_df<span class="sc">$</span>splitname <span class="ot">=</span> <span class="st">&#39;split_0&#39;</span></span></code></pre></div>
<p>And add them in:</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="visualising-pace-across-splits.html#cb393-1" aria-hidden="true" tabindex="-1"></a>long_splits_rebased <span class="ot">=</span> <span class="fu">bind_rows</span>(long_splits_rebased, zero_df)</span></code></pre></div>
<p>The off-the-pace chart is intended to show how much time is lost over the course of a stage, the gradient of the slope in each section being an indicator of the pace differential within that section (i.e. between two consecutive split points).</p>
<p>The off-the-pace chart is most easily generated from a long dataframe containing the accumulated stage time rather than the sectional times.</p>
<p>For example, we can cast the wide form data to a long form and co-opt the pace chart to render the times for us:</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="visualising-pace-across-splits.html#cb394-1" aria-hidden="true" tabindex="-1"></a>long_splits_rebased <span class="sc">%&gt;%</span></span>
<span id="cb394-2"><a href="visualising-pace-across-splits.html#cb394-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">off_the_pace_chart</span>(<span class="at">dist=</span><span class="st">&#39;distance&#39;</span>,</span>
<span id="cb394-3"><a href="visualising-pace-across-splits.html#cb394-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">t=</span><span class="st">&#39;sectionDurationS&#39;</span>,</span>
<span id="cb394-4"><a href="visualising-pace-across-splits.html#cb394-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">label_typ=</span><span class="st">&#39;ggrepel&#39;</span>,</span>
<span id="cb394-5"><a href="visualising-pace-across-splits.html#cb394-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">code=</span><span class="st">&#39;code&#39;</span>)</span></code></pre></div>
<p><img src="images/finding-splits-pace-rebased_splits_pace-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-split-times.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/RallyDataJunkie/rally-event-sketches-2021/edit/master/finding-splits-pace.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/RallyDataJunkie/rally-event-sketches-2021/blob/master/finding-splits-pace.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toc_depth": 3,
"toolbar": {
"position": "fixed"
},
"search": true,
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
